---
import ProjectCard from './ProjectCard.astro'
import Separator from '../common/Separator.astro'
import Heading from '../common/Heading.astro'

// PROJECTS
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
projects.sort((a, b) => {
  return a.data.id - b.data.id;
});

const emptyCells = [2, 5, 7, 8, 9];

let projectsGrid: any[] = projects;
emptyCells.forEach((pos) => {
  projectsGrid.splice(pos, 0, null)
})
---

<section id="projects">
  <Separator />
  <Heading id="01">Nos projets</Heading>

  <div class="project-container">
    <div class="project-grid">
      {projectsGrid.map((project, index) => {
        const ProjectCell = (
          <div class="project-cell">
            {project ? (
              <div class="padding">
                <ProjectCard
                  slug={project.slug}
                  title={project.data.title}
                  type={project.data.type}
                  thumbnail={project.data.thumbnail}
                  preview={project.data.preview}
                  id={project.data.id > 9 ? "" + project.data.id : "0" + project.data.id}
                />
              </div>
              <div class="borders">
                <div class="border top"></div>
                <div class="border right"></div>
                <div class="border bottom"></div>
                <div class="border left"></div>
              </div>
            ) : (
              <div>
                <div class="padding">
                  <div class="empty"></div>
                </div>
                <div class="borders">
                  <div class="border top"></div>
                  <div class="border right"></div>
                  <div class="border bottom"></div>
                  <div class="border left"></div>
                </div>
              </div>
            )}
          </div>
        );

        return ProjectCell;
      })}
    </div>
  </div>
</section>

<style>
  section {
    margin-top: -8rem;
    padding-top: 8rem;
  }
  .project-container {
    margin-left: -.5rem;
    margin-right: -.5rem;
  }
  .project-grid {
    margin-top: 2rem;
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
  }
  .project-grid .project-cell {
    position: relative;
  }
  .project-grid .project-cell .padding {
    padding: .5rem;
  }
  .project-grid .project-cell .empty {
    aspect-ratio: 1/1;
    background-image: linear-gradient(45deg, var(--black-3) 25%, var(--black-0) 25%, var(--black-0) 50%, var(--black-3) 50%, var(--black-3) 75%, var(--black-0) 75%, var(--black-0) 100%);
    background-size: 56.57px 56.57px;
  }
  .project-grid .project-cell .borders {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
  .project-grid .project-cell .borders .border.top {
    position: absolute;
    width: 100%;
    top: .5rem;
    border-top: 1px solid var(--black-10);
  }
  .project-grid .project-cell .borders .border.bottom {
    position: absolute;
    width: 100%;
    bottom: .5rem;
    border-bottom: 1px solid var(--black-10);
  }
  .project-grid .project-cell .borders .border.right {
    position: absolute;
    height: 100%;
    right: .5rem;
    border-right: 1px solid var(--black-10);
  }
  .project-grid .project-cell .borders .border.left {
    position: absolute;
    height: 100%;
    left: .5rem;
    border-left: 1px solid var(--black-10);
  }

  @media screen and (max-width: 1024px) {
    .project-grid {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }

  @media screen and (max-width: 768px) {
    section {
      margin-top: -6rem;
      padding-top: 6rem;
    }
    .project-grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  @media screen and (max-width: 480px) {
    .project-grid .project-cell .padding {
      padding: .25rem;
    }
    .project-grid .project-cell .borders .border.top {
      top: .25rem;
    }
    .project-grid .project-cell .borders .border.bottom {
      bottom: .25rem;
    }
    .project-grid .project-cell .borders .border.right {
      right: .25rem;
    }
    .project-grid .project-cell .borders .border.left {
      left: .25rem;
    }
  }
</style>